(this["webpackJsonpyorkie-codepair"]=this["webpackJsonpyorkie-codepair"]||[]).push([[0],{217:function(e,t,n){},218:function(e,t,n){},22:function(e,t,n){"use strict";(function(e){function a(e,t,n,a){return e.addEventListener(t,n,a)}function r(e,t,n,a){return e.removeEventListener(t,n,a)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var o={mouseup:"touchend",mouseout:"touchend",mousedown:"touchstart",mousemove:"touchmove"},c={mouseup:"pointerup",mouseout:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"},i={mouseup:"MSPointerUp",mouseout:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};function s(t,n,a,r){e.navigator.pointerEnabled?n(t,c[a],r):e.navigator.msPointerEnabled?n(t,i[a],r):(n(t,o[a],r),n(t,a,r))}}).call(this,n(55))},220:function(e,t,n){},222:function(e,t,n){"use strict";n.r(t);var a,r,o,c=n(0),i=n.n(c),s=n(13),l=n.n(s),u=n(8),d=n(75),h=n(289),m=n(141),f=n(19),v=n(95),p=n(286),b=n(142),g=n(285),y=n(29),E=n(26),O=n(27),j=function(){function e(t){Object(E.a)(this,e),this.key=void 0,this.storage=void 0,this.key=t,this.storage=window.localStorage}return Object(O.a)(e,[{key:"getValue",value:function(e){try{return JSON.parse(this.storage[this.key])}catch(t){return e}}},{key:"setValue",value:function(e){this.storage[this.key]=JSON.stringify(e)}}]),e}();!function(e){e.Dark="dark",e.Light="light"}(a||(a={})),function(e){e.Sublime="sublime",e.Vim="vim",e.Emacs="emacs"}(r||(r={})),function(e){e.Two="2",e.Four="4",e.Eight="8"}(o||(o={}));var k=new j("$$codepair$$setting"),x=k.getValue({menu:{theme:a.Dark,codeKeyMap:r.Sublime,tabSize:o.Two}}),C=Object(y.c)({name:"setting",initialState:x,reducers:{setDarkMode:function(e,t){e.menu.theme=t.payload?a.Dark:a.Light,k.setValue(e)},setCodeKeyMap:function(e,t){e.menu.codeKeyMap=t.payload,k.setValue(e)},setTabSize:function(e,t){e.menu.tabSize=t.payload,k.setValue(e)}}}),w=C.actions,S=w.setDarkMode,D=w.setCodeKeyMap,N=w.setTabSize,L=C.reducer,R=n(268),M=n(295),T=n(278),z=n(279),I=n(148),B=n(17),A=n(229),P=n(270),W=n(293),F=n(78),K=n.n(F),V=n(264);function Y(e){var t=e.anchorEl,n=e.onClose,a=e.children,r=e.anchorOrigin,o=e.transformOrigin,c=Boolean(t);return i.a.createElement(V.a,{id:c?"simple-popover":void 0,open:c,anchorEl:t,onClose:n,anchorOrigin:r,transformOrigin:o},a)}Y.defaultProps={anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}};var H,X=n(269),U=n(225),G=Object(R.a)((function(){return{root:function(e){return{color:e.peer.metadata.color}}}}));function J(e){var t=G(e),n=e.peer;return i.a.createElement(U.a,{className:t.root},n.metadata.username)}!function(e){e.Connected="connected",e.Disconnected="disconnected"}(H||(H={}));var $=Object(y.c)({name:"peer",initialState:{peers:{}},reducers:{syncPeer:function(e,t){for(var n=t.payload,a=n.myClientID,r=n.changedPeers,o=e.peers,c=0,i=Object.keys(o);c<i.length;c++){var s=i[c];r[s]||(o[s].status=H.Disconnected)}for(var l=0,u=Object.entries(r);l<u.length;l++){var d=Object(B.a)(u[l],2),h=d[0],m=d[1];if(!o[h]||o[h].status===H.Disconnected){var f={id:h,status:H.Connected,metadata:m,isMine:a===h};e.peers[h]=f}}}}}),q=$.actions.syncPeer,_=$.reducer;function Q(){var e=Object(u.c)((function(e){return e.docState.client})),t=Object(u.c)((function(e){return e.peerState.peers}));return{activePeers:Object(c.useMemo)((function(){return e?Object.values(t).filter((function(e){return e.status===H.Connected})):[]}),[e,t])}}function Z(){var e=Q().activePeers;return i.a.createElement(X.a,null,i.a.createElement(U.a,null,i.a.createElement(I.a,null,"Total ",e.length)),e.map((function(e){return i.a.createElement(J,{key:e.id,peer:e})})))}var ee=Object(R.a)((function(e){return{group:{"& > *":{cursor:"pointer"}},myAvatar:{borderColor:e.palette.secondary.main}}}));function te(){var e=ee(),t=Object(u.c)((function(e){return e.docState.client})),n=Q().activePeers,a=Object(c.useState)(),r=Object(B.a)(a,2),o=r[0],s=r[1],l=Object(c.useCallback)((function(e){e.target.getAttribute("data-id")||s(e.currentTarget)}),[s]),d=Object(c.useCallback)((function(){s(void 0)}),[s]);return t?i.a.createElement(i.a.Fragment,null,i.a.createElement(P.a,{className:e.group,max:4,onClick:l},n.map((function(t){var n=t.metadata,a=n.username,r=n.color,o=n.image;return i.a.createElement(W.a,{key:t.id,title:t.isMine?"[ME] ".concat(a):a,"data-id":t.id,arrow:!0},i.a.createElement(A.a,{alt:"Peer Image",className:t.isMine?e.myAvatar:"",style:{backgroundColor:r},src:K.a.getImage(o)}))}))),i.a.createElement(Y,{anchorEl:o,onClose:d},i.a.createElement(Z,null))):null}var ne=n(129),ae=n(290),re=n(277),oe=n(273),ce=n(132),ie=n.n(ce),se=n(133),le=n.n(se),ue=n(144),de=n(5),he=n(298),me=n(272),fe=n(274),ve=n(275),pe=n(130),be=n.n(pe),ge=n(271),ye=Object(de.a)((function(e){return Object(M.a)({root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})}))((function(e){var t=e.children,n=e.classes,a=e.onClose,r=Object(ue.a)(e,["children","classes","onClose"]);return i.a.createElement(me.a,Object.assign({disableTypography:!0,className:n.root},r),i.a.createElement(I.a,{variant:"h6"},t),a?i.a.createElement(oe.a,{"aria-label":"close",className:n.closeButton,onClick:a},i.a.createElement(be.a,null)):null)})),Ee=Object(de.a)((function(e){return{root:{padding:e.spacing(2)}}}))(fe.a),Oe=Object(de.a)((function(e){return{root:{margin:0,padding:e.spacing(1)}}}))(ve.a);function je(e){var t=e.open,n=e.onClose,a=e.className,r=e.children;return t?i.a.createElement(he.a,{onClose:n,open:t,maxWidth:"md"},i.a.createElement("div",{className:a},r)):null}je.defaultProps={className:""};var ke=je,xe=n(276);function Ce(e){var t=e.timeout,n=e.show,a=e.onFadeout,r=e.children,o=Object(c.useRef)(null);return Object(c.useEffect)((function(){return n&&(o.current=window.setTimeout((function(){a(),o.current=null}),t)),function(){o.current&&clearTimeout(o.current)}}),[n]),i.a.createElement(xe.a,{in:n},i.a.createElement("div",null,n?r:null))}Ce.defaultProps={timeout:1e3};var we,Se,De=Ce,Ne=n(45),Le=n.n(Ne),Re=n(74),Me=n(97),Te=n.n(Me),ze=n(131),Ie=n.n(ze);!function(e){e.Markdown="gfm",e.Go="go",e.JavaScript="javascript",e.Clojure="clojure",e.Dart="dart",e.Python="python",e.Ruby="ruby",e.Rust="rust"}(we||(we={})),function(e){e.Disconnect="disconnect",e.Connect="connect"}(Se||(Se={}));var Be={mode:we.Markdown,loading:!0,errorMessage:"",status:Se.Connect},Ae=Object(y.b)("doc/activate",function(){var e=Object(Re.a)(Le.a.mark((function e(t,n){var a,r,o,c;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=K.a.generate(),r=a.name,o=a.animal,c=Te.a.createClient("".concat("https://api.yorkie.dev"),{metadata:{username:r,image:o,color:Ie()()}}),e.next=5,c.activate();case 5:return e.abrupt("return",{client:c});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",n.rejectWithValue(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}()),Pe=Object(y.b)("doc/attach",function(){var e=Object(Re.a)(Le.a.mark((function e(t,n){var a,r;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.client,r=t.doc,e.prev=1,e.next=4,a.attach(r);case 4:return r.update((function(e){e.content||e.createText("content"),e.shapes||(e.shapes=[])})),e.next=7,a.sync();case 7:return e.abrupt("return",{doc:r,client:a});case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",n.rejectWithValue(e.t0.message));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),We=Object(y.c)({name:"doc",initialState:Be,reducers:{deactivateClient:function(e){var t=e.client;e.client=void 0,null===t||void 0===t||t.deactivate()},createDocument:function(e,t){e.doc=Te.a.createDocument("codepairs",t.payload)},detachDocument:function(e){var t=e.doc,n=e.client;e.doc=void 0,null===n||void 0===n||n.detach(t)},attachDocLoading:function(e,t){e.loading=t.payload},setCodeMode:function(e,t){e.mode=t.payload},setStatus:function(e,t){e.status=t.payload}},extraReducers:function(e){e.addCase(Ae.fulfilled,(function(e,t){var n=t.payload;e.client=n.client})),e.addCase(Ae.rejected,(function(e,t){var n=t.payload;e.errorMessage=n})),e.addCase(Pe.fulfilled,(function(e,t){var n=t.payload;e.doc=n.doc,e.client=n.client})),e.addCase(Pe.rejected,(function(e,t){var n=t.payload;e.errorMessage=n}))}}),Fe=We.actions,Ke=Fe.deactivateClient,Ve=Fe.createDocument,Ye=Fe.detachDocument,He=Fe.attachDocLoading,Xe=Fe.setCodeMode,Ue=Fe.setStatus,Ge=We.reducer,Je=Object(R.a)((function(){return{dialog:{borderRadius:"4px"},input:{width:"300px",padding:"12px 8px",fontSize:"18px",borderRadius:"5px",outline:"none",backgroundColor:"hsla(0,0%,100%,0.9)"}}}));function $e(){var e=Je(),t=Object(u.c)((function(e){return e.docState.status})),n=Object(c.useState)(!1),a=Object(B.a)(n,2),r=a[0],o=a[1],s=Object(c.useState)(!1),l=Object(B.a)(s,2),d=l[0],h=l[1],m=Object(c.useRef)(null),f=window.location.href.split("?")[0],v=Object(c.useCallback)((function(){var e;null===(e=m.current)||void 0===e||e.select()}),[]),p=Object(c.useCallback)((function(){h(!0)}),[]),b=Object(c.useCallback)((function(){o(!0)}),[]),g=Object(c.useCallback)((function(){o(!1)}),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(re.a,{size:"small",color:"primary",variant:"contained",startIcon:i.a.createElement(ie.a,null),onClick:b,disabled:t===Se.Disconnect},"Share"),i.a.createElement(ke,{open:r,onClose:g,className:e.dialog},i.a.createElement(ye,{onClose:g},"Share Code"),i.a.createElement(Ee,{dividers:!0},i.a.createElement(ae.a,{my:3},i.a.createElement(I.a,null,"Anyone can access the code in real time through this URL.")),i.a.createElement(ae.a,{my:1},i.a.createElement(ge.a,null,"Share this URL")),i.a.createElement(ae.a,{display:"flex"},i.a.createElement("input",{readOnly:!0,ref:m,className:e.input,value:f,onFocus:v}),i.a.createElement(ne.CopyToClipboard,{text:f,onCopy:p},i.a.createElement(oe.a,{color:"primary"},i.a.createElement(le.a,null))),i.a.createElement(De,{show:d,onFadeout:function(){return h(!1)}},i.a.createElement("p",null,"Copy!")))),i.a.createElement(Oe,null,i.a.createElement(re.a,{onClick:g,color:"primary",variant:"contained",autoFocus:!0},"Close"))))}var qe=n(135),_e=n.n(qe),Qe=n(134),Ze=n.n(Qe),et=Object(R.a)((function(){return Object(M.a)({root:{width:"380px"},title:{backgroundColor:"hsla(0,0%,100%,0.1)","& > *":{fontWeight:"bold"}}})}));function tt(e){var t=e.title,n=e.subTitle,a=e.content,r=et();return i.a.createElement("div",{className:r.root},i.a.createElement(ae.a,{px:2,py:1.5,className:r.title},i.a.createElement(I.a,{variant:"subtitle1"},t)),i.a.createElement(ae.a,{px:2,p:1},i.a.createElement(ae.a,{py:1},i.a.createElement(I.a,{variant:"body1"},n)),i.a.createElement(ae.a,{pb:2.5},i.a.createElement(I.a,{variant:"body2"},a))))}function nt(e){var t=Object(c.useState)(),n=Object(B.a)(t,2),a=n[0],r=n[1],o=e.hasLocalChanges,s=Object(c.useCallback)((function(e){r(e.currentTarget)}),[]),l=Object(c.useCallback)((function(){r(void 0)}),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(re.a,{"aria-label":"doc-status",color:"secondary",startIcon:i.a.createElement(Ze.a,null),onClick:s},"Working offline"),i.a.createElement(Y,{anchorEl:a,onClose:l,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},i.a.createElement(tt,{title:o?"There are changes that couldn't be sent to Server":"All Changes saved to Server",subTitle:"This document is ready for offline use",content:"Looks like you're offline. Changes will save to this memory now, and save to Server once reconnected."})))}function at(){var e=Object(c.useState)(),t=Object(B.a)(e,2),n=t[0],a=t[1],r=Object(c.useCallback)((function(e){a(e.currentTarget)}),[]),o=Object(c.useCallback)((function(){a(void 0)}),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(re.a,{"aria-label":"doc-status",color:"secondary",onClick:r},i.a.createElement(_e.a,null)),i.a.createElement(Y,{anchorEl:n,onClose:o,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},i.a.createElement(tt,{title:"All Changes saved to Server",subTitle:"This document is ready for offline use",content:"You can edit this document without an internet connection. Changes will save to Server once reconnected."})))}function rt(){var e=Object(u.c)((function(e){return e.docState.status})),t=Object(u.c)((function(e){return!!e.docState.doc&&e.docState.doc.hasLocalChanges()}));return e===Se.Connect?i.a.createElement(at,null):i.a.createElement(nt,{hasLocalChanges:t})}var ot=Object(R.a)((function(e){return Object(M.a)({root:{flexGrow:1},appBar:{backgroundColor:"black"},grow:{flexGrow:1},title:{fontWeight:"bold",color:e.palette.primary.main,marginRight:e.spacing(1)},items:{display:"flex","& > *":{margin:e.spacing(1)}}})}));function ct(){var e=ot();return i.a.createElement("div",{className:e.root},i.a.createElement(T.a,{position:"static",className:e.appBar},i.a.createElement(z.a,null,i.a.createElement(I.a,{variant:"h6",className:e.title},"CodePair"),i.a.createElement(rt,null),i.a.createElement("div",{className:e.grow}),i.a.createElement("div",{className:e.items},i.a.createElement($e,null),i.a.createElement(te,null)))))}var it=Object(c.memo)(ct),st=n(291),lt=n(281),ut=n(280),dt=n(136),ht=n.n(dt),mt=n(299),ft=Object(R.a)((function(e){return Object(M.a)({root:{minWidth:"320px",borderRadius:"4px"},header:{borderBottom:"1px solid ".concat(e.palette.text.disabled)},title:{padding:"12px 16px"},list:{padding:"8px 18px 18px 18px",lineHeight:"19px"},item:{display:"flex",justifyContent:"space-between",fontSize:"15px",marginTop:"12px"},itemTitle:{whiteSpace:"nowrap",display:"flex",alignItems:"center"},itemInfo:{minWidth:140,paddingLeft:"12px",borderRadius:"4px",textAlign:"left"}})})),vt=function(){var e=Object(u.b)(),t=ft(),n=Object(u.c)((function(e){return e.settingState.menu}));function s(t){return function(n){e(t(n.target.value))}}var l=Object(c.useCallback)((function(t,n){e(S(n))}),[e,S]);return i.a.createElement("div",{className:t.root},i.a.createElement(ae.a,null,i.a.createElement("header",{className:t.header},i.a.createElement(I.a,{className:t.title,variant:"h6"},"Settings"))),i.a.createElement("div",{className:t.list},i.a.createElement("div",{className:t.item},i.a.createElement("div",{className:t.itemTitle},"Dark Mode"),i.a.createElement(ut.a,{className:t.itemInfo},i.a.createElement(mt.a,{checked:n.theme===a.Dark,onChange:l}))),i.a.createElement("div",{className:t.item},i.a.createElement("div",{className:t.itemTitle},"Key Binding"),i.a.createElement(ut.a,{className:t.itemInfo},i.a.createElement(st.a,{value:n.codeKeyMap,onChange:s(D),displayEmpty:!0},Object.entries(r).map((function(e){var t=Object(B.a)(e,2),n=t[0],a=t[1];return i.a.createElement(lt.a,{value:a,key:a},n)}))))),i.a.createElement("div",{className:t.item},i.a.createElement("div",{className:t.itemTitle},"Tab Size"),i.a.createElement(ut.a,{className:t.itemInfo},i.a.createElement(st.a,{value:n.tabSize,onChange:s(N),displayEmpty:!0},Object.entries(o).map((function(e){var t=Object(B.a)(e,2),n=t[0],a=t[1];return i.a.createElement(lt.a,{value:a,key:n},"".concat(a," spaces"))})))))))},pt=Object(R.a)((function(e){return Object(M.a)({root:{padding:"6px",position:"relative"},formControl:{minWidth:140,border:"1px solid ".concat(e.palette.grey[800]),borderRadius:"4px"},selectEmpty:{paddingLeft:"12px"},rightButtonControl:{float:"right"},rightButton:{padding:"7px"}})}));function bt(){var e=pt(),t=Object(u.b)(),n=Object(u.c)((function(e){return e.docState.doc})),a=Object(u.c)((function(e){return e.docState.mode})),r=Object(c.useState)(),o=Object(B.a)(r,2),s=o[0],l=o[1];Object(c.useEffect)((function(){if(!n)return function(){};var e=n.subscribe((function(e){"remote-change"===e.type&&t(Xe(n.getRoot().mode||we.Markdown))}));return function(){e()}}),[n]);var d=Object(c.useCallback)((function(e){if(n){var a=e.target.value;n.update((function(e){e.mode=a})),t(Xe(a))}}),[n,t]),h=Object(c.useCallback)((function(e){l(e.currentTarget)}),[]),m=Object(c.useCallback)((function(){l(void 0)}),[]);return i.a.createElement("div",{className:e.root},i.a.createElement(ut.a,{className:e.formControl},i.a.createElement(W.a,{title:"Syntax",arrow:!0},i.a.createElement(st.a,{name:"codeMode",value:a,onChange:d,className:e.selectEmpty,disableUnderline:!0,displayEmpty:!0},Object.entries(we).map((function(e){var t=Object(B.a)(e,2),n=t[0],a=t[1];return i.a.createElement(lt.a,{value:a,key:a},n)}))))),i.a.createElement("div",{className:e.rightButtonControl},i.a.createElement(W.a,{className:e.rightButton,title:"Settings",arrow:!0},i.a.createElement(oe.a,{"aria-label":"settings",onClick:h},i.a.createElement(ht.a,{fontSize:"small"})))),i.a.createElement(Y,{anchorEl:s,onClose:m},i.a.createElement(vt,null)))}var gt,yt=n(294),Et=n(292),Ot=n(284),jt=n(44),kt=n(137),xt=n(138),Ct=n.n(xt);!function(e){e.Deactivated="deactivated",e.Activated="activated"}(gt||(gt={}));var wt,St,Dt=function(){function e(t,n){Object(E.a)(this,e),this.id=void 0,this.username=void 0,this.color=void 0,this.height=void 0,this.marker=void 0,this.lineMarker=void 0,this.status=void 0,this.nameRemoveTimeMap=void 0,this.nameAnimationDelay=void 0,this.nameAnimationDuration=void 0,this.nameRemoveTime=void 0,this.id=t,this.username=n.username,this.color=n.color,this.height=0,this.status=gt.Deactivated,this.nameRemoveTimeMap=new Map,this.nameAnimationDelay=1,this.nameAnimationDuration=.2,this.nameRemoveTime=1e3*(this.nameAnimationDuration+this.nameAnimationDelay)}return Object(O.a)(e,[{key:"updateCursor",value:function(e,t){this.removeCursor(),this.status=gt.Activated;var n=e.cursorCoords(t),a=document.createElement("span");this.height=n.bottom-n.top,a.classList.add("codePair-cursor"),a.style.borderLeftColor=this.color,a.style.height="".concat(this.height,"px"),this.marker=e.setBookmark(t,{widget:a,insertLeft:!0}),this.showCursorNameReserve(a)}},{key:"updateLine",value:function(e,t,n){this.removeLine(),this.status=gt.Activated,this.lineMarker=e.getDoc().markText(t,n,{css:"background-color : ".concat(this.color,"; opacity:0.7")})}},{key:"showCursorNameReserve",value:function(e){var t=this,n=document.createElement("span");n.classList.add("codePair-name"),e.addEventListener("mouseenter",(function(){t.nameRemoveTimeMap.has(t.id)&&clearTimeout(t.nameRemoveTimeMap.get(t.id)),n.textContent=t.username,n.style.top="-".concat(t.height,"px"),n.style.backgroundColor=t.color,n.style.color=Ct()(t.color,!0),n.classList.remove("text-remove"),e.appendChild(n)})),e.addEventListener("mouseleave",(function(){n.classList.add("text-remove"),n.style.animationDuration="".concat(t.nameAnimationDuration,"s"),n.style.animationDelay="".concat(t.nameAnimationDelay,"s"),t.removeNameReserve(n)}))}},{key:"removeNameReserve",value:function(e){var t=this,n=setTimeout((function(){e.parentNode.removeChild(e),t.nameRemoveTimeMap.delete(t.id)}),this.nameRemoveTime);this.nameRemoveTimeMap.set(this.id,n)}},{key:"removeCursor",value:function(){this.marker&&(this.marker.clear(),this.marker=void 0)}},{key:"removeLine",value:function(){this.lineMarker&&(this.lineMarker.clear(),this.lineMarker=void 0)}},{key:"clear",value:function(){this.removeCursor(),this.removeLine()}},{key:"isActive",value:function(){return this.status===gt.Activated}}]),e}();n(192),n(193),n(195),n(196),n(201),n(202),n(204),n(205),n(207),n(208),n(209),n(210),n(211),n(212),n(214),n(215),n(216),n(217);function Nt(e){var t=e.forwardedRef,n=Object(u.c)((function(e){return e.docState.doc})),r=Object(u.c)((function(e){return e.docState.mode})),o=Object(u.c)((function(e){return e.docState.client})),s=Object(u.c)((function(e){return e.peerState.peers})),l=Object(u.c)((function(e){return e.settingState.menu})),d=Object(c.useRef)(new Map),h=Object(c.useCallback)((function(e,t){d.current.set(e,new Dt(e,t))}),[]),m=Object(c.useCallback)((function(e){d.current.has(e)&&(d.current.get(e).clear(),d.current.delete(e))}),[]);return Object(c.useEffect)((function(){for(var e=0,t=Object.entries(s);e<t.length;e++){var n=Object(B.a)(t[e],2),a=n[0],r=n[1];d.current.has(a)&&r.status===H.Disconnected?m(a):d.current.has(a)||r.status!==H.Connected||h(a,r.metadata)}}),[s]),o&&n?i.a.createElement(kt.UnControlled,{className:"CodeMirror",options:{mode:r,theme:l.theme===a.Dark?"monokai":"xq-light",keyMap:l.codeKeyMap,tabSize:Number(l.tabSize),lineNumbers:!0,lineWrapping:!0,autoCloseTags:!0,autoCloseBrackets:!0},editorDidMount:function(e){t.current=e,e.focus();var a=function(t,n){var a=d.current.get(t);null===a||void 0===a||a.updateCursor(e,n)};n.subscribe((function(t){if("remote-change"===t.type){var n,r=Object(jt.a)(t.value);try{for(r.s();!(n=r.n()).done;){var c=n.value.change.getID().getActorID();if(c!==o.getID()){if(!d.current.has(c))return;if(d.current.get(c).isActive())return;a(c,e.posFromIndex(0))}}}catch(i){r.e(i)}finally{r.f()}}}));var r=n.getRoot();r.content.onChanges((function(t){t.forEach((function(t){var n=t.actor,r=t.from,c=t.to;if("content"===t.type){var i=t.content||"";if(n!==o.getID()){var s=e.posFromIndex(r),l=e.posFromIndex(c);e.replaceRange(i,s,l,"yorkie")}}else if("selection"===t.type&&n!==o.getID()){var u=e.posFromIndex(r),h=e.posFromIndex(c);if(a(n,h),r>c){var m=[u,h];h=m[0],u=m[1]}!function(t,n,a){var r=d.current.get(t);null===r||void 0===r||r.updateLine(e,n,a)}(n,u,h)}}))})),e.setValue(r.content.getValue())},onSelection:function(e,t){if(t.origin){var a=e.indexFromPos(t.ranges[0].anchor),r=e.indexFromPos(t.ranges[0].head);n.update((function(e){e.content.select(a,r)}))}},onBeforeChange:function(e,t){if("yorkie"!==t.origin&&"setValue"!==t.origin){var a=e.indexFromPos(t.from),r=e.indexFromPos(t.to),o=t.text.join("\n");n.update((function(e){e.content.edit(a,r,o)}))}}}):null}!function(e){e.Red="#d8453c",e.Blue="#19abbf",e.Green="#699e3d",e.White="#cccccc",e.Yellow="#f3b328",e.Black="#444"}(wt||(wt={})),function(e){e[e.None=0]="None",e[e.Line=1]="Line",e[e.Eraser=2]="Eraser",e[e.Rect=3]="Rect",e[e.Selector=4]="Selector"}(St||(St={}));var Lt={isOpen:!1,color:wt.Black,tool:St.None},Rt=Object(y.c)({name:"board",initialState:Lt,reducers:{toggleBoard:function(e){e.isOpen=!e.isOpen},setTool:function(e,t){e.tool=t.payload},setColor:function(e,t){e.color=t.payload}}}),Mt=Rt.actions,Tt=(Mt.toggleBoard,Mt.setTool),zt=Mt.setColor,It=Rt.reducer,Bt=function(){function e(t){Object(E.a)(this,e),this.name=void 0,this.callbacks=void 0,this.name=t,this.callbacks=[]}return Object(O.a)(e,[{key:"on",value:function(e){this.callbacks.push(e)}},{key:"off",value:function(e){var t=this.callbacks.findIndex((function(t){return t===e}));this.callbacks.splice(t,1)}},{key:"toString",value:function(){return this.name}}]),e}(),At=function(){function e(){Object(E.a)(this,e),this.events=void 0,this.events={}}return Object(O.a)(e,[{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];this.events[e]&&this.events[e].callbacks.forEach((function(e){e.apply(void 0,n)}))}},{key:"addEventListener",value:function(e,t){this.events[e]||(this.events[e]=new Bt(e)),this.events[e].on(t)}},{key:"removeEventListener",value:function(e,t){t?this.events[e].off(t):delete this.events[e]}}]),e}(),Pt=function(){function e(t){Object(E.a)(this,e),this.canvas=void 0,this.context=void 0,this.width=0,this.height=0,this.canvas=t,this.context=t.getContext("2d"),this.resize(),this.context.lineWidth=3,this.context.lineCap="round"}return Object(O.a)(e,[{key:"getCanvas",value:function(){return this.canvas}},{key:"getContext",value:function(){return this.context}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"setWidth",value:function(e,t){this.width=e,this.canvas.width=t?e*t:e,this.canvas.style.width="".concat(e,"px")}},{key:"setHeight",value:function(e,t){this.height=e,this.canvas.height=t?e*t:e,this.canvas.style.height="".concat(e,"px")}},{key:"setSize",value:function(e,t,n){this.setWidth(e,n),this.setHeight(t,n)}},{key:"clear",value:function(){this.getContext().clearRect(0,0,this.getWidth(),this.getHeight())}},{key:"resize",value:function(){var e=window.devicePixelRatio;e?(this.setSize(this.canvas.width,this.canvas.height,e),this.context.scale(e,e)):this.setSize(this.canvas.width,this.canvas.height)}}]),e}(),Wt=n(104),Ft=n(143);function Kt(e,t){var n=e.x-t.x,a=e.y-t.y;return n*n+a*a}function Vt(e,t,n){var a=t.x,r=t.y,o=n.x-a,c=n.y-r;if(0!==o||0!==c){var i=((e.x-a)*o+(e.y-r)*c)/(o*o+c*c);i>1?(a=n.x,r=n.y):i>0&&(a+=o*i,r+=c*i)}return(o=e.x-a)*o+(c=e.y-r)*c}function Yt(e,t,n,a,r){for(var o=a,c=0,i=t+1;i<n;i+=1){var s=Vt(e[i],e[t],e[n]);s>o&&(c=i,o=s)}o>a&&(t+1<c&&Yt(e,t,c,a,r),r.push(e[c]),c+1<n&&Yt(e,c,n,a,r))}function Ht(e,t){var n=e.length-1,a=[];return a.push(e[0]),Yt(e,0,n,t,a),a.push(e[n]),a}function Xt(e,t){for(var n=e[0],a=n,r=[a],o=1,c=e.length;o<c;o+=1)Kt(n=e[o],a)>t&&(r.push(n),a=n);return a!==n&&r.push(n),r}function Ut(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return Ht(Xt(e,t),t)}function Gt(e,t,n,a){var r,o,c={x:0,y:0,onLine1:!1,onLine2:!1},i=(a.y-n.y)*(t.x-e.x)-(a.x-n.x)*(t.y-e.y);if(0===i)return c;r=e.y-n.y,o=e.x-n.x;var s=(a.x-n.x)*r-(a.y-n.y)*o,l=(t.x-e.x)*r-(t.y-e.y)*o;return r=s/i,o=l/i,c.x=e.x+r*(t.x-e.x),c.y=e.y+r*(t.y-e.y),r>0&&r<1&&(c.onLine1=!0),o>0&&o<1&&(c.onLine2=!0),c}function Jt(e){return{y:e.y,x:e.x,width:e.width,height:e.height}}function $t(e,t){var n=e.y+e.height,a=e.x+e.width;return!(e.height>0?n<t.y:n>t.y)&&(!(e.y>t.y)&&(!(e.height>0?a<t.x:a>t.x)&&!(e.x>t.x)))}function qt(e,t){e.beginPath();var n=e.strokeStyle;e.strokeStyle="eraser"===t.type?"#ff7043":t.color;var a,r=!1,o=Object(jt.a)(t.points);try{for(o.s();!(a=o.n()).done;){var c=a.value;!1===r?(r=!0,e.moveTo(c.x,c.y)):e.lineTo(c.x,c.y)}}catch(i){o.e(i)}finally{o.f()}e.stroke(),e.strokeStyle=n,e.closePath()}function _t(e){return{y:e.y+8,x:e.x+6}}function Qt(e,t){e.strokeRect(t.box.x,t.box.y,t.box.width,t.box.height)}var Zt,en,tn=[];var nn,an=function(){function e(t){Object(E.a)(this,e),this.update=void 0,this.selectedShape=void 0,this.update=t}return Object(O.a)(e,[{key:"createShape",value:function(e,t,n){var a;return this.update((function(r){if(e===St.Line){var o=function(e,t){return{type:"line",color:t.color,points:[e]}}(t,n);r.shapes.push(o)}else if(e===St.Eraser){var c=function(e){return{type:"eraser",points:[e]}}(t);r.shapes.push(c)}else if(e===St.Rect){var i=function(e){return{type:"rect",box:{x:e.x,y:e.y,width:0,height:0},points:[{x:e.x,y:e.y}]}}(t);r.shapes.push(i)}var s=r.shapes.getLast();a=s.getID()})),a}},{key:"selectShape",value:function(e){var t,n=this;return this.update((function(t){var a,r=Object(jt.a)(t.shapes);try{for(r.s();!(a=r.n()).done;){var o=a.value;if((null===o||void 0===o?void 0:o.box)&&$t(o.box,e))return void(n.selectedShape={shape:o,point:e,status:"move"})}}catch(c){r.e(c)}finally{r.f()}n.selectedShape=void 0})),null===(t=this.selectedShape)||void 0===t?void 0:t.shape}},{key:"isEmptySelectedShape",value:function(){return!this.selectedShape}},{key:"executeTask",value:function(e,t,n){var a=this;!function(e){en=function(){tn.length>0&&(e(tn),tn=[])},Zt=setInterval(en,50)}((function(r){r.length<2||a.update((function(o){if(t===St.Line){var c,i=Ut(r.map((function(e){return e.point})));(c=o.shapes.getElementByID(e).points).push.apply(c,Object(Ft.a)(i)),n(o.shapes)}else if(t===St.Eraser){var s=Ut(r.map((function(e){return e.point}))),l=_t(s[0]),u=_t(s[s.length-1]),d=o.shapes.getElementByID(e),h=function(e,t){var n,a=Object(jt.a)(o.shapes);try{for(a.s();!(n=a.n()).done;){var r=n.value;if("rect"===r.type)$t(r.box,t)&&o.shapes.deleteByID(r.getID());else for(var c=1;c<r.points.length;c+=1){var i=Gt(e,t,r.points[c-1],r.points[c]);if(i.onLine1&&i.onLine2){o.shapes.deleteByID(r.getID());break}}}}catch(s){a.e(s)}finally{a.f()}};if(d.points.length>0)h(d.points[d.points.length-1],l);h(l,u),d.points=[l,u],n(o.shapes)}else if(t===St.Rect){var m=r[r.length-1].point,f=o.shapes.getElementByID(e),v=function(e,t){var n=Jt(e.box),a=e.points[0],r=t.x-a.x,o=t.y-a.y,c=Math.abs(r),i=Math.abs(o);return n.x=a.x-(r>0?0:-r),n.y=a.y-(o>0?0:-o),n.width=c,n.height=i,n}(f,m);f.box=v,n(o.shapes)}else if(t===St.Selector){if(a.isEmptySelectedShape())return;var p=o.shapes.getElementByID(e),b=r[r.length-1].point,g=b.y-a.selectedShape.point.y,y=b.x-a.selectedShape.point.x;a.selectedShape.point=b,p.box=Object(Wt.a)(Object(Wt.a)({},Jt(p.box)),{},{y:p.box.y+g,x:p.box.x+y}),p.points[0]={y:p.points[0].y+g,x:p.points[0].x+y},n(o.shapes)}}))}))}},{key:"reserveTask",value:function(e){!function(e){tn.push(e)}(e)}},{key:"flushTask",value:function(e,t,n){clearInterval(Zt),"function"===typeof en&&en(),en=void 0,e&&this.update((function(a){t===St.Line?a.shapes.getElementByID(e).points.length<2&&(a.shapes.deleteByID(e),n(a.shapes)):t===St.Eraser&&(a.shapes.deleteByID(e),n(a.shapes))}))}}]),e}(),rn=n(22);!function(e){e[e.Drag=0]="Drag",e[e.Stop=1]="Stop"}(nn||(nn={}));var on=function(){function e(t,n){Object(E.a)(this,e),this.pointY=void 0,this.pointX=void 0,this.offsetY=void 0,this.offsetX=void 0,this.scene=void 0,this.tool=void 0,this.color=void 0,this.createId=void 0,this.dragStatus=void 0,this.update=void 0,this.worker=void 0,this.eventDispatcher=void 0,this.pointY=0,this.pointX=0,this.tool=St.Line,this.color=wt.Black,this.dragStatus=nn.Stop,this.update=n,this.scene=new Pt(t),this.eventDispatcher=new At;var a=this.scene.getCanvas().getBoundingClientRect(),r=a.y,o=a.x;this.offsetY=r,this.offsetX=o,this.init(),this.worker=new an(this.update)}return Object(O.a)(e,[{key:"init",value:function(){this.scene.getContext().strokeStyle=this.color,this.drawAll=this.drawAll.bind(this),this.onmouseup=this.onmouseup.bind(this),this.onmousedown=this.onmousedown.bind(this),this.onmousemove=this.onmousemove.bind(this),Object(rn.c)(this.scene.getCanvas(),rn.a,"mouseup",this.onmouseup),Object(rn.c)(this.scene.getCanvas(),rn.a,"mouseout",this.onmouseup),Object(rn.c)(this.scene.getCanvas(),rn.a,"mousedown",this.onmousedown)}},{key:"destroy",value:function(){Object(rn.c)(this.scene.getCanvas(),rn.b,"mouseup",this.onmouseup),Object(rn.c)(this.scene.getCanvas(),rn.b,"mouseout",this.onmouseup),Object(rn.c)(this.scene.getCanvas(),rn.b,"mousedown",this.onmousedown)}},{key:"setColor",value:function(e){this.color=e}},{key:"setTool",value:function(e){this.setMouseClass(e),this.tool=e}},{key:"setMouseClass",value:function(e){this.scene.getCanvas().className="",e===St.Line||e===St.Rect?this.scene.getCanvas().classList.add("crosshair","canvas-touch-none"):e===St.Eraser&&this.scene.getCanvas().classList.add("eraser","canvas-touch-none")}},{key:"getMouse",value:function(e){var t,n;return window.TouchEvent&&e instanceof TouchEvent?(t=e.touches[0].clientY,n=e.touches[0].clientX):(t=e.clientY,n=e.clientX),t+=window.scrollY,n+=window.scrollX,{y:t-this.offsetY,x:n-this.offsetX}}},{key:"onmousedown",value:function(e){Object(rn.c)(this.scene.getCanvas(),rn.a,"mousemove",this.onmousemove),this.dragStatus=nn.Drag;var t=this.getMouse(e);if(this.tool===St.Line||this.tool===St.Eraser||this.tool===St.Rect)this.createId=this.worker.createShape(this.tool,t,{color:this.color}),this.worker.executeTask(this.createId,this.tool,this.drawAll);else if(this.tool===St.Selector){var n=this.worker.selectShape(t);n&&this.worker.executeTask(n.getID(),this.tool,this.drawAll)}}},{key:"onmousemove",value:function(e){var t=this.getMouse(e);this.isOutSide(t)||this.dragStatus!==nn.Stop&&(this.tool!==St.Line&&this.tool!==St.Eraser&&this.tool!==St.Rect&&this.tool!==St.Selector||this.worker.reserveTask({point:t}))}},{key:"onmouseup",value:function(){Object(rn.c)(this.scene.getCanvas(),rn.b,"mousemove",this.onmousemove),this.dragStatus=nn.Stop,this.tool!==St.Line&&this.tool!==St.Eraser&&this.tool!==St.Rect&&this.tool!==St.Selector||this.worker.flushTask(this.createId,this.tool,this.drawAll),this.createId=void 0,this.emit("mouseup")}},{key:"isOutSide",value:function(e){return(e.y<0||e.x<0||e.y>this.scene.getHeight()||e.x>this.scene.getWidth())&&(this.onmouseup(),!0)}},{key:"drawAll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scene;t.clear();var n,a=Object(jt.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;this.draw(r,t)}}catch(o){a.e(o)}finally{a.f()}}},{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scene;"line"===e.type||"eraser"===e.type?qt(t.getContext(),e):"rect"===e.type&&Qt(t.getContext(),e)}},{key:"clear",value:function(){this.scene.clear()}},{key:"emit",value:function(e){for(var t,n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];(t=this.eventDispatcher).emit.apply(t,[e].concat(a))}},{key:"on",value:function(e,t){this.eventDispatcher.addEventListener(e,t)}},{key:"off",value:function(e,t){this.eventDispatcher.removeEventListener(e,t)}}]),e}();n(218);function cn(e){var t=e.width,n=e.height,a=Object(c.useRef)(null),r=Object(c.useRef)(null),o=Object(u.b)(),s=Object(u.c)((function(e){return e.docState.doc})),l=Object(u.c)((function(e){return e.boardState.tool})),d=Object(u.c)((function(e){return e.boardState.color}));return Object(c.useEffect)((function(){if(!a.current||!s)return function(){};a.current.width=t,a.current.height=n;var e=new on(a.current,s.update.bind(s));r.current=e,r.current.setTool(l),r.current.setColor(d),r.current.drawAll(s.getRoot().shapes);var c=function(){l===St.Rect&&o(Tt(St.Selector))};return r.current.on("mouseup",c),function(){var t;null===(t=r.current)||void 0===t||t.off("mouseup",c),e.destroy()}}),[t,n,s,l,d]),Object(c.useEffect)((function(){if(!s)return function(){};var e=s.subscribe((function(e){var t;"remote-change"===e.type&&(null===(t=r.current)||void 0===t||t.drawAll(s.getRoot().shapes))}));return function(){e()}}),[s]),Object(c.useEffect)((function(){var e;null===(e=r.current)||void 0===e||e.setTool(l)}),[s,l]),i.a.createElement("canvas",{ref:a})}var sn=n(139),ln=n.n(sn),un=n(283),dn=n(89);function hn(e){var t=e.fontSize;return i.a.createElement(dn.a,{fontSize:t},i.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 480.001 480.001"},i.a.createElement("g",null,i.a.createElement("g",null,i.a.createElement("path",{d:"M333.142,350.846c0.115-0.115,0.215-0.239,0.323-0.357l129.681-129.706c10.878-10.878,16.864-25.368,16.855-40.8 c-0.01-15.409-5.999-29.865-16.854-40.694l-97.844-97.874c-10.853-10.845-25.326-16.817-40.75-16.817 c-15.426,0-29.895,5.974-40.741,16.82L16.855,308.329C5.974,319.21-0.012,333.713,0,349.168 c0.013,15.425,6.002,29.884,16.854,40.7l62.592,62.606c0.061,0.061,0.127,0.112,0.188,0.171c0.174,0.165,0.349,0.331,0.534,0.483 c0.082,0.067,0.171,0.126,0.255,0.19c0.175,0.135,0.349,0.271,0.532,0.395c0.07,0.047,0.145,0.085,0.215,0.13 c0.205,0.131,0.412,0.26,0.627,0.376c0.051,0.026,0.103,0.048,0.154,0.074c0.239,0.123,0.482,0.241,0.732,0.346 c0.033,0.014,0.067,0.024,0.101,0.037c0.269,0.108,0.54,0.208,0.819,0.293c0.034,0.011,0.07,0.017,0.104,0.027 c0.276,0.081,0.556,0.154,0.841,0.211c0.082,0.017,0.165,0.023,0.247,0.038c0.239,0.041,0.479,0.084,0.724,0.107 c0.33,0.033,0.663,0.051,0.998,0.051h137.91h159.308c5.522,0,10-4.478,10-10c0-5.522-4.478-10-10-10H248.566l84.22-84.236 C332.904,351.06,333.027,350.96,333.142,350.846z M220.285,435.404H90.66l-59.675-59.689 c-7.076-7.054-10.977-16.487-10.985-26.563c-0.008-10.106,3.897-19.582,10.996-26.681l129.825-129.803l151.091,151.091 L220.285,435.404z M174.965,178.527L297.953,55.56c7.069-7.069,16.516-10.963,26.6-10.963c10.085,0,19.536,3.895,26.609,10.962 l97.85,97.88c7.08,7.063,10.982,16.493,10.989,26.557c0.006,10.085-3.899,19.547-10.998,26.645l-122.95,122.974L174.965,178.527z"})))))}function mn(e){var t=e.fontSize;return i.a.createElement(dn.a,{fontSize:t},i.a.createElement("svg",{viewBox:"-36 0 392 392.40392",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("path",{d:"m43 355.03125c.492188 3.949219 3.273438 7.230469 7.085938 8.355469 3.816406 1.128906 7.933593-.109375 10.492187-3.152344l68.5-81.507813 72.972656 109.230469c3.058594 4.585938 9.25 5.828125 13.84375 2.777344l65.226563-43.285156c4.589844-3.046875 5.851562-9.234375 2.820312-13.835938l-72.304687-109.675781 101.714843-31.453125c3.800782-1.175781 6.542969-4.488281 6.984376-8.441406.441406-3.953125-1.5-7.792969-4.945313-9.777344l-300.195313-172.929687c-3.289062-1.894532-7.363281-1.765626-10.523437.332031-3.160156 2.097656-4.863281 5.804687-4.394531 9.566406zm242.539062-174.878906-92.539062 28.617187c-3.003906.929688-5.398438 3.21875-6.460938 6.179688-1.058593 2.960937-.664062 6.25 1.066407 8.875l74.152343 112.476562-48.613281 32.261719-74.832031-112.023438c-1.746094-2.617187-4.625-4.257812-7.765625-4.429687-.183594-.011719-.367187-.015625-.550781-.015625-2.953125 0-5.753906 1.308594-7.652344 3.566406l-62.320312 74.152344-37.421876-301.128906zm0 0"})))}function fn(e){var t=e.fontSize;return i.a.createElement(dn.a,{fontSize:t},i.a.createElement("svg",{enableBackground:"new 0 0 506.1 506.1",viewBox:"0 0 506.1 506.1",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("path",{d:"m489.609 506.1h-473.118c-9.108 0-16.491-7.384-16.491-16.491v-473.118c0-9.108 7.383-16.491 16.491-16.491h473.119c9.107 0 16.49 7.383 16.49 16.491v473.118c0 9.107-7.383 16.491-16.491 16.491zm-456.628-32.982h440.138v-440.137h-440.138z"})))}var vn=n(282),pn=n(98),bn=n.n(pn),gn=Object(R.a)((function(e){return Object(M.a)({button:{marginLeft:3,marginRight:3,padding:8},select:{marginLeft:3,marginRight:3,padding:8,color:e.palette.primary.main},box:{width:"184px",display:"flex",flexWrap:"wrap","& > *":{margin:e.spacing(1)}},colorIcon:{"&:hover":{cursor:"pointer"},width:e.spacing(3.1),height:e.spacing(3.1)},badge:{backgroundColor:function(e){return e.color}}})}));function yn(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.boardState.tool})),n=Object(u.c)((function(e){return e.boardState.color})),a=Object(c.useState)(),r=Object(B.a)(a,2),o=r[0],s=r[1],l=gn({color:n}),d=Object(c.useCallback)((function(e){s(e.currentTarget)}),[t]),h=Object(c.useCallback)((function(){s(void 0)}),[]),m=Object(c.useCallback)((function(n){t!==St.Line?e(Tt(St.Line)):d(n)}),[t,n]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(W.a,{title:"Brush",arrow:!0,className:t===St.Line?l.select:l.button},i.a.createElement(oe.a,{"aria-label":"Brush",onClick:m},t===St.Line?i.a.createElement(vn.a,{variant:"dot",classes:{badge:l.badge},anchorOrigin:{vertical:"bottom",horizontal:"right"}},i.a.createElement(bn.a,{fontSize:"small"})):i.a.createElement(bn.a,{fontSize:"small"}))),i.a.createElement(Y,{anchorEl:o,onClose:h,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"}},i.a.createElement(ae.a,{p:2,className:l.box},Object.entries(wt).map((function(a){var r,o=Object(B.a)(a,2),c=o[0],s=o[1],u=n===s&&t===St.Line;return i.a.createElement(W.a,{key:c,title:c,arrow:!0},i.a.createElement(ae.a,{border:3,borderRadius:"50%",borderColor:u?"primary.main":""},i.a.createElement(A.a,{className:l.colorIcon,style:{backgroundColor:s},onClick:(r=s,function(){e(Tt(St.Line)),e(zt(r)),h()})}," ")))})))))}var En=Object(R.a)((function(e){return Object(M.a)({root:{display:"flex",flexDirection:"column"},divider:{marginTop:5,marginBottom:5},button:{marginLeft:3,marginRight:3,padding:8},select:{marginLeft:3,marginRight:3,padding:8,color:e.palette.primary.main}})}));function On(){var e=En(),t=Object(u.b)(),n=Object(u.c)((function(e){return e.boardState.tool})),a=function(e){return function(){t(Tt(e))}};return i.a.createElement("div",{className:e.root},i.a.createElement(W.a,{title:"Code",arrow:!0,className:n===St.None?e.select:e.button},i.a.createElement(oe.a,{"aria-label":"Code",onClick:a(St.None)},i.a.createElement(ln.a,{fontSize:"small"}))),i.a.createElement(un.a,{className:e.divider}),i.a.createElement(yn,null),i.a.createElement(W.a,{title:"Rect",arrow:!0,className:n===St.Rect?e.select:e.button},i.a.createElement(oe.a,{"aria-label":"rect",onClick:a(St.Rect)},i.a.createElement(fn,{fontSize:"small"}))),i.a.createElement(W.a,{title:"Selector",arrow:!0,className:n===St.Selector?e.select:e.button},i.a.createElement(oe.a,{"aria-label":"selector",onClick:a(St.Selector)},i.a.createElement(mn,{fontSize:"small"}))),i.a.createElement(W.a,{title:"Eraser",arrow:!0,className:n===St.Eraser?e.select:e.button},i.a.createElement(oe.a,{"aria-label":"eraser",onClick:a(St.Eraser)},i.a.createElement(hn,{fontSize:"small"}))))}var jn=110,kn=Object(R.a)((function(){return Object(M.a)({root:{flexGrow:1,display:"flex"},editor:{width:"calc(100% - ".concat(42,"px)")},codeEditor:{width:"100%",height:"calc(100vh - ".concat(jn,"px)")},canvas:{top:jn,height:"calc(100vh - ".concat(jn,"px)"),width:"calc(100% - ".concat(42,"px)"),position:"fixed",zIndex:function(e){return e===St.None?1:10}}})}));function xn(e){var t=e.tool,n=kn(t),a=Object(c.useState)(0),r=Object(B.a)(a,2),o=r[0],s=r[1],l=Object(c.useState)(0),u=Object(B.a)(l,2),d=u[0],h=u[1],m=Object(c.useRef)(null),f=Object(c.useRef)(null),v=Object(c.useCallback)((function(){var e;t===St.None&&(null===(e=f.current)||void 0===e||e.focus())}),[t]);return Object(c.useEffect)((function(){var e=function(){var e;if(m.current){var t=null===(e=m.current)||void 0===e?void 0:e.getBoundingClientRect();s(t.width),h(t.height)}};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),i.a.createElement("div",{className:n.root,onClick:v,"aria-hidden":"true"},i.a.createElement("div",{className:n.editor,ref:m},i.a.createElement("div",{className:n.codeEditor},i.a.createElement(Nt,{forwardedRef:f})),i.a.createElement("div",{className:n.canvas},i.a.createElement(cn,{width:o,height:d}))),i.a.createElement(On,null))}var Cn=Object(R.a)((function(){return Object(M.a)({loading:{display:"flex",height:"calc(100vh - ".concat(jn,"px)"),alignItems:"center",justifyContent:"center"}})})),wn=function(e){var t=e.docKey,n=Cn(),a=Object(u.b)(),r=Object(u.c)((function(e){return e.docState.client})),o=Object(u.c)((function(e){return e.docState.doc})),s=Object(u.c)((function(e){return e.docState.status})),l=Object(u.c)((function(e){return e.boardState.tool})),d=Object(u.c)((function(e){return e.docState.loading})),h=Object(u.c)((function(e){return e.docState.errorMessage}));return Object(c.useEffect)((function(){return a(Ae()),function(){a(Ke())}}),[]),Object(c.useEffect)((function(){if(!r||!o)return function(){};var e=r.subscribe((function(e){if("peers-changed"===e.type){var t=o.getKey(),n=e.value[t];a(q({myClientID:r.getID(),changedPeers:n}))}s===Se.Connect&&("status-changed"===e.type&&"deactivated"===e.value||"stream-connection-status-changed"===e.type&&"disconnected"===e.value||"document-sync-result"===e.type&&"sync-failed"===e.value)?a(Ue(Se.Disconnect)):s===Se.Disconnect&&("peers-changed"===e.type||"documents-changed"===e.type||"status-changed"===e.type&&"activated"===e.value||"stream-connection-status-changed"===e.type&&"connected"===e.value||"document-sync-result"===e.type&&"synced"===e.value)&&a(Ue(Se.Connect))}));return function(){e()}}),[r,o,s]),Object(c.useEffect)((function(){return a(Ve(t)),function(){a(Ye())}}),[t]),Object(c.useEffect)((function(){function e(){return(e=Object(Re.a)(Le.a.mark((function e(){return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&o){e.next=2;break}return e.abrupt("return");case 2:return a(He(!0)),e.next=5,a(Pe({client:r,doc:o}));case 5:a(Xe(o.getRoot().mode||we.Markdown)),a(He(!1));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){a(He(!0))}}),[t,r,o]),h?i.a.createElement("div",null,i.a.createElement(yt.a,{open:!0,anchorOrigin:{vertical:"top",horizontal:"center"}},i.a.createElement(Et.a,{severity:"warning"},h||"fail to attach document"))):d?i.a.createElement(ae.a,{className:n.loading},i.a.createElement(Ot.a,{color:"inherit"})):i.a.createElement(xn,{tool:l})},Sn=Object(R.a)((function(){return Object(M.a)({root:{flexGrow:1}})}));function Dn(e){var t=Sn(),n=Object(f.f)(),a=e.match.params.docKey;return Object(c.useEffect)((function(){d.a.set({page:n.pathname}),d.a.pageview(n.pathname)}),[n]),i.a.createElement("div",{className:t.root},i.a.createElement(it,null),i.a.createElement(bt,null),i.a.createElement(wn,{docKey:a}))}n(220);var Nn=function(){var e=Object(u.c)((function(e){return e.settingState.menu})),t=Object(c.useMemo)((function(){return Object(b.a)({palette:{type:e.theme===a.Dark?"dark":"light",primary:{main:"#d8b01a"},secondary:{main:"#e6b602"}}})}),[e]),n=Object(c.useCallback)((function(){return i.a.createElement(f.a,{to:"/".concat(Math.random().toString(36).substring(7))})}),[]);return i.a.createElement(g.a,{theme:t},i.a.createElement(p.a,null),i.a.createElement(v.a,null,i.a.createElement(f.b,{path:"/",exact:!0,render:n}),i.a.createElement(f.b,{path:"/:docKey",exact:!0,component:Dn})))},Ln=n(28),Rn=Object(Ln.c)({docState:Ge,peerState:_,settingState:L,boardState:It}),Mn=Object(y.a)({reducer:Rn,middleware:Object(y.d)({serializableCheck:{ignoredActions:["doc/attach/fulfilled","doc/activate/fulfilled"],ignoredPaths:["docState.client","docState.doc"]},immutableCheck:{ignoredPaths:["docState.client","docState.doc"]}})});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));d.a.initialize("UA-42438082-5"),h.a({dsn:"https://d287d6df8c6f423189266360055e6ca7@o553194.ingest.sentry.io/5680102",release:"yorkie-codepair@".concat("198e459"),integrations:[new m.a.BrowserTracing],tracesSampleRate:1}),l.a.render(i.a.createElement(u.a,{store:Mn},i.a.createElement(Nn,null)),document.querySelector("#root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[222,1,2]]]);
//# sourceMappingURL=main.3450a150.chunk.js.map