(this["webpackJsonpyorkie-codepair"]=this["webpackJsonpyorkie-codepair"]||[]).push([[0],{110:function(e,t,n){},112:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),c=n(6),i=n.n(c),l=n(47),u=n(9),s=n(24),m=n(150),d=n(149),f=n(27),p=n(62),O=n(25),g=n(37),v=n.n(g),b=n(63),h=n(49),E=n.n(h);!function(e){e.ATTACH_DOC="ATTACH_DOC",e.LOAD_DOC="LOAD_DOC",e.ERROR="ERROR"}(a||(a={}));var j={client:null,doc:null,loading:!1,errorMessage:""},y=Object(f.c)({docState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.ATTACH_DOC:return Object(O.a)(Object(O.a)({},e),{},{client:t.client,doc:t.doc});case a.LOAD_DOC:return Object(O.a)(Object(O.a)({},e),{},{loading:t.loading});case a.ERROR:return Object(O.a)(Object(O.a)({},e),{},{errorMessage:t.errorMessage,doc:null});default:return e}}});var C=n(142),k=n(155),x=n(71),D=n(143),w=n(145),R=n(146),A=n(147),T=n(67),S=n.n(T),M=n(154),_=n(151),F=Object(C.a)((function(e){return Object(k.a)({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})}));function L(){var e=F(),t=o.a.useState(null),n=Object(x.a)(t,2),a=n[0],r=n[1],c=Boolean(a),i=function(){r(null)};return o.a.createElement("div",{className:e.root},o.a.createElement(D.a,{position:"static"},o.a.createElement(w.a,null,o.a.createElement(R.a,{variant:"h6",className:e.title},"Yorkie CodePair"),o.a.createElement("div",null,o.a.createElement(A.a,{"aria-label":"settings","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){r(e.currentTarget)},color:"inherit"},o.a.createElement(S.a,null)),o.a.createElement(_.a,{id:"menu-appbar",anchorEl:a,keepMounted:!0,open:c,onClose:i},o.a.createElement(M.a,{onClick:i},"Theme"),o.a.createElement(M.a,{onClick:i},"Editor Mode"),o.a.createElement(M.a,{onClick:i},"Tab Size"),o.a.createElement(M.a,{onClick:i},"Font Size"))))))}var N=n(68),B=n(69),H=n(152),I=n(153),K=n(148),G=(n(108),n(109),Object(C.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}})));function P(e){var t=Object(s.b)(),n=G();Object(r.useEffect)((function(){var n,r;t((n=!0,function(e){return e({type:a.LOAD_DOC,loading:n})})),t((r=e.docKey,function(){var e=Object(b.a)(v.a.mark((function e(t){var n,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=E.a.createClient("".concat("/api")),e.next=4,n.activate();case 4:return o=E.a.createDocument("codepairs",r),e.next=7,n.attach(o);case 7:return o.update((function(e){e.content||e.createText("content")})),e.next=10,n.sync();case 10:t({type:a.ATTACH_DOC,doc:o,client:n}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),t({type:a.ERROR,errorMessage:e.t0.message});case 17:t({type:a.LOAD_DOC,loading:!1});case 18:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}()))}),[]);var c=Object(s.c)((function(e){return e.docState.loading})),i=Object(s.c)((function(e){return e.docState.client})),l=Object(s.c)((function(e){return e.docState.doc})),u=Object(s.c)((function(e){return e.docState.errorMessage}));return c?o.a.createElement(H.a,{height:"100%"},o.a.createElement(K.a,{color:"secondary"})):u||null===i||null===l?o.a.createElement("div",{className:n.root},o.a.createElement(I.a,{severity:"error"},u||"fail to attach document")):o.a.createElement(B.UnControlled,{options:{mode:"xml",theme:"monokai",lineNumbers:!0},editorDidMount:function(e){var t=l.getRootObject();t.content.onChanges((function(t){var n,a=Object(N.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if("content"===r.type){var o=r.actor,c=r.from,l=r.to,u=r.content||"";if(o!==i.getID()){console.log("%c remote: ".concat(c,"-").concat(l,": ").concat(u),"color: skyblue");var s=e.posFromIndex(c),m=e.posFromIndex(l);e.replaceRange(u,s,m,"yorkie")}}else if("selection"===r.type){r.actor;i.getID()}}}catch(d){a.e(d)}finally{a.f()}})),e.setValue(t.content.getValue())},onBeforeChange:function(e,t){if(console.log(t.origin,t.text),"yorkie"!==t.origin&&"setValue"!==t.origin){var n=e.indexFromPos(t.from),a=e.indexFromPos(t.to),r=t.text.join("\n");l.update((function(e){e.content.edit(n,a,r)}))}}})}var V=Object(C.a)((function(e){return Object(k.a)({root:{flexGrow:1}})}));function z(e){var t=V(),n=e.match.params.docKey;return o.a.createElement("div",{className:t.root},o.a.createElement(L,null),o.a.createElement(P,{docKey:n}))}var J=n(70),W=Object(J.a)({palette:{type:"dark"}}),q=(n(110),Object(f.d)(y,void 0,Object(f.a)(p.a)));var U=function(){return o.a.createElement(s.a,{store:q},o.a.createElement(d.a,{theme:W},o.a.createElement(m.a,null),o.a.createElement(l.a,null,o.a.createElement(u.b,{path:"/",exact:!0,render:function(){return o.a.createElement(u.a,{to:"/".concat(Math.random().toString(36).substring(7))})}}),o.a.createElement(u.b,{path:"/:docKey",exact:!0,component:z}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(U,null),document.querySelector("#root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},79:function(e,t,n){e.exports=n(112)}},[[79,1,2]]]);
//# sourceMappingURL=main.d0b5ea9f.chunk.js.map